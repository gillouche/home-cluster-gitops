apiVersion: constraints.gatekeeper.sh/v1beta1
kind: K8sBlockStandaloneSecret
metadata:
  name: block-standalone-secrets
spec:
  match:
    kinds:
      - apiGroups: [""]
        kinds: ["Secret"]
    excludedNamespaces:
      - kube-system
      - sealed-secrets
      - argocd # ArgoCD repo creds are often raw (managed by GUI/CLI)
      - longhorn-system
      - calico-system
      - tigera-operator
      - cert-manager
      - monitoring # Helm chart generates secrets without ownerRefs
