apiVersion: v1
kind: ConfigMap
metadata:
  name: attic-config
  namespace: attic
data:
  server.toml: |
    # Attic Server Configuration
    listen = "[::]:8080"

    [database]
    # Provided via ATTIC_SERVER_DATABASE_URL env var

    [storage]
    type = "s3"
    region = "us-east-1"
    bucket = "attic-cache"
    endpoint = "http://seaweedfs-s3.seaweedfs.svc.cluster.local:8333"

    [signing]
    # The signing key used to sign cache artifacts
    # This is different from the JWT secret
    key = "/secrets/signing-key"

    [chunking]
    nar-min-size = 16384
    nar-avg-size = 65536
    nar-max-size = 262144

    [compression]
    type = "zstd"
    level = 3

    [garbage-collector]
    interval = "24 hours"
    default-retention-period = "3 months"
